<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>OGE Task 1 ‚Äî Preparation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- –®—Ä–∏—Ñ—Ç Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- –û–±—â–∏–µ —Å—Ç–∏–ª–∏ -->
  <link rel="stylesheet" href="../../../style_common.css" />

  <!-- –ê–Ω—Ç–∏-–º–∏–≥–∞–Ω–∏–µ —Ç–µ–º—ã -->
  <script>
    (function(){
      try{
        const saved = localStorage.getItem('pref-theme') || 'light';
        if (saved === 'dark') document.documentElement.classList.add('dark');
      }catch(_){}
    })();
  </script>

  <style>
    .reading-box{
      background:var(--card);
      border:1px solid #ccc;
      border-radius:12px;
      box-shadow:var(--shadow);
      padding:24px 28px;
      text-align:left;
      font-family: Inter, system-ui, Segoe UI, Roboto, Arial, sans-serif;
      font-size:25px;
      line-height:1.7;
      max-width:1200px;
      margin:0 auto 24px;
      white-space:pre-line;
    }
    @media (max-width:900px){
      .reading-box{ font-size:18px; padding:18px 16px; max-width:100%; }
    }
    .helper-box{
      border:1px solid #ccc;          
      border-radius:8px;              
      padding:14px 18px;              
      background:var(--card);
      max-width:800px;                
      margin:16px auto;               
      font-family: Inter, system-ui, Segoe UI, Roboto, Arial, sans-serif;
      font-size:18px;
      line-height:1.5;
      box-shadow:0 2px 6px rgba(0,0,0,0.08); 
    }
    @media (max-width:900px){
      .helper-box{ font-size:16px; padding:12px 14px; max-width:100%; }
    }
    .wordlist{
      width:100%;
      border-collapse: collapse;
      font-size:18px;
      table-layout: fixed;
    }
    .wordlist th, .wordlist td{
      padding:6px 4px;
      border-bottom:1px solid #e4e7ef;
      vertical-align: middle;
    }
    .dark .wordlist th, .wordlist td{
      border-bottom:1px solid rgba(255,255,255,.12);
    }
    .wordlist th{ text-align:left; font-weight:600; }
    .wordlist td:nth-child(1){ width:35%; }
    .wordlist td:nth-child(2){ width:45%; }
    .wordlist td:nth-child(3){ width:20%; text-align:center; }
    .wordlist th:nth-child(3){ text-align:center; }
    .wordlist button.play{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      line-height:1;
      min-width:36px;
      height:28px;
      border:none;
      background:linear-gradient(135deg, var(--primary), var(--primary-600));
      color:#fff;
      border-radius:6px;
      padding:4px 8px;
      font-size:14px;
      cursor:pointer;
      box-shadow:0 3px 8px rgba(43,108,255,.25);
      transition:transform .08s ease, filter .2s ease;
    }
    .wordlist button.play:hover{ transform:translateY(-1px); filter:brightness(1.05); }
  </style>
</head>
<body>
  <button id="themeBtn" class="theme-toggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåì –¢–µ–º–∞</button>

  <div class="content-wrapper">
    <div class="task-container" role="region" aria-labelledby="taskTitle">
      <p id="taskTitle" style="margin-top:0;">
        <strong>Task 1.</strong> You are going to read the text aloud. 
        You have <strong>1.5 minutes</strong> to read it silently, 
        and then you will have to read it aloud. 
        You will not have more than <strong>2 minutes</strong> to read it aloud.
      </p>
    </div>

    <div class="reading-box" id="readingBox">
Modern technologies are rapidly changing the world of work. New professions appear almost every year. For example, specialists in artificial intelligence, digital marketing and biotechnology are in great demand today. According to scientists, many traditional jobs will disappear in the next twenty years. However, new careers will certainly be created instead. Employers say that young people should be flexible, creative and ready to learn throughout their lives. Although nobody can predict the future exactly, experts believe that communication skills and knowledge of foreign languages will always be valuable. Choosing a profession is never easy, but it is important to think about modern trends. Some schools now offer special courses that introduce teenagers to computer programming, design or business. Such opportunities help students to make better decisions and prepare for future achievements.
    </div>

    <div class="task-container helper-box" role="region" aria-labelledby="hardWordsTitle">
      <details>
        <summary id="hardWordsTitle" style="cursor:pointer; font-weight:700;">
          üîé –°–ª–æ–∂–Ω—ã–µ —Å–ª–æ–≤–∞ (–ø–æ–¥—Å–∫–∞–∑–∫–∞) ‚Äî –Ω–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å
        </summary>
        <div class="wordlist-wrap" style="margin-top:14px;">
          <table class="wordlist" aria-label="–°–ø–∏—Å–æ–∫ —Å–ª–æ–∂–Ω—ã—Ö —Å–ª–æ–≤ —Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–µ–π –∏ –æ–∑–≤—É—á–∫–æ–π">
            <thead>
              <tr>
                <th>Word</th>
                <th>IPA</th>
                <th>Audio</th>
              </tr>
            </thead>
            <tbody id="hardWordsTbody"></tbody>
          </table>
        </div>
      </details>
    </div>

    <div style="text-align:center; margin:22px 0 30px;">
      <button id="goBtn" class="button" type="button" aria-label="–ü–µ—Ä–µ–π—Ç–∏ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é">–ü–µ—Ä–µ–π—Ç–∏ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é</button>
    </div>
  </div>

  <div style="height: calc(var(--footer-h) + 24px);"></div>

  <div id="progressContainerFixed" role="timer" aria-live="polite" aria-atomic="true" aria-label="–û—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏">
    <div id="progressBarFixed" class="rAF">
      <span id="progressTime" class="progress-time">01:30</span>
    </div>
  </div>

  <script type="module">
    import { toggleThemeInit, navigateOnce, startPrepareTimer, fmtTime } from "../../../common.js";

    toggleThemeInit();

    const NEXT_URL = location.pathname.replace(/_1_prepare\.html$/i, '_2_mic.html');
    document.getElementById('goBtn')?.addEventListener('click', () => navigateOnce(NEXT_URL));

    try{
      sessionStorage.removeItem('oge1_audio_base64');
      sessionStorage.removeItem('oge1_audio_mime');
      sessionStorage.setItem('oge1_prepared', '1');
      sessionStorage.setItem('oge1_meta', JSON.stringify({
        preparedAt: Date.now(),
        prepareDurationSec: 90
      }));
    }catch{}

    const TOTAL_MS = 90_000;
    const barEl  = document.getElementById('progressBarFixed');
    const timeEl = document.getElementById('progressTime');
    let stopTimer = null;

    function startTimerFresh(){
      timeEl.textContent = fmtTime(TOTAL_MS);
      barEl.style.width  = '100%';
      try { stopTimer?.(); } catch {}
      stopTimer = startPrepareTimer({
        barEl,
        timeEl,
        totalMs: TOTAL_MS,
        nextUrl: NEXT_URL,
        key: 'oge1_prepare_end',
        persist: false,
        textEveryMs: 250,
        useRAF: true
      });
    }
    startTimerFresh();

    window.addEventListener('pageshow', (e)=>{
      try { navigateOnce.lock = false; } catch {}
      if (e.persisted) startTimerFresh();
    });

    const HARD_WORDS = [
      { w: 'technologies',            ipa: '/tekÀàn…íl…ôd íiz/' },
      { w: 'professions',             ipa: '/pr…ôÀàfe É…ônz/' },
      { w: 'artificial intelligence', ipa: '/Àå…ëÀêt…™Ààf…™ Él …™nÀàtel…™d í…ôns/' },
      { w: 'digital marketing',       ipa: '/Ààd…™d í…™tl Ààm…ëÀêk…™t…™≈ã/' },
      { w: 'biotechnology',           ipa: '/Àåba…™…ô ätekÀàn…íl…ôd íi/' },
      { w: 'disappear',               ipa: '/Àåd…™s…ôÀàp…™…ô/' },
      { w: 'communication skills',    ipa: '/k…ôÀåmjuÀên…™Ààke…™ Én sk…™lz/' },
      { w: 'foreign languages',       ipa: '/Ààf…ír…™n Ààl√¶≈ã…°w…™d í…™z/' },
      { w: 'opportunities',           ipa: '/Àå…íp…ôÀàtjuÀên…™tiz/' },
      { w: 'achievements',            ipa: '/…ôÀàt ÉiÀêvm…ônts/' }
    ];

    (function renderHardWords(){
      const tbody = document.getElementById('hardWordsTbody');
      if (!tbody) return;
      tbody.innerHTML = '';
      HARD_WORDS.forEach((item) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${item.w}</td>
          <td>${item.ipa}</td>
          <td><button class="play" type="button" aria-label="–ü—Ä–æ—Å–ª—É—à–∞—Ç—å ${item.w}"><span aria-hidden="true">‚ñ∂Ô∏é</span></button></td>
        `;
        tr.querySelector('button').addEventListener('click', () => speakWord(item.w));
        tbody.appendChild(tr);
      });
    })();

    let voices = [];
    function loadVoices(){ voices = window.speechSynthesis?.getVoices?.() || []; }
    loadVoices();
    if ('speechSynthesis' in window) {
      window.speechSynthesis.addEventListener('voiceschanged', loadVoices);
    }

    function pickEnglishVoice(){
      if (!voices || !voices.length) return null;
      const byLang = (substr) => voices.find(v => (v.lang || '').toLowerCase().startsWith(substr));
      return (byLang('en-gb')) || (byLang('en-us')) || voices.find(v => (v.lang || '').toLowerCase().startsWith('en')) || null;
    }

    function speakWord(word){
      try{
        if (!('speechSynthesis' in window)) return;
        const u = new SpeechSynthesisUtterance(word);
        const v = pickEnglishVoice();
        if (v) u.voice = v;
        u.rate = 0.95;
        u.lang = (v?.lang) || 'en-GB';
        window.speechSynthesis.cancel();
        window.speechSynthesis.speak(u);
      }catch(e){ console.warn('Speech error:', e); }
    }
  </script>
</body>
</html>
